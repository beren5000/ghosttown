{% extends "base.html" %}
{% load i18n %}
{% load l10n %}
{% load staticfiles %}
{% load bootstrap3 %}
{% block title %}Republica de los Fantasmas{% endblock %}

{% block navbar %}
{% endblock %}

{% block content %}
    <div id="republic"></div>
    <div class="row background_hexagon_header">
        <div class="container2 ">
                <div class="col-xs-5">
                    <img id="home-logo" src="{% static 'ghosttown/img/asset-43.svg' %}">
                </div>
                <div class="col-xs-offset-3 col-xs-4 text-header">
                    ¡Bienvenidos a este nuevo y posible mundo!
                    Para el ingreso a nuestra República es importante
                    tener presente tu numero de identidad
                </div>

        </div>
    </div>
    <div class="row">

        <div id="map"></div>

    </div>
    {% include  'sections/navbar.html' %}

    <div id="ideology" style="width: 100%; height: 50px;"></div>
    <div class="row push-down-30">
        <div class="container2">
            <div class="row">
                <div class="col-xs-12">
                    <img src="{% static 'ghosttown/img/assets2-35.svg' %}">
                </div>
            </div>
            <div class="row push-down-30">
                <div class="col-xs-12">
                    <p class="home-text-ideology">
                        La República de los Fantasmas es un espacio en el que el significado de poder se convierte en
                        una construcción comunitaria, transformando la idea de república y desvirtuando decisiones que
                        afectan, vigilan y someten a los individuos; por esta razón, la construcción de esta se
                        convierte en un acto de resistencia silencioso, frente a la dominación del ser humano y su
                        manipulación en el orden natural. Esta República de los Fantasmas posibilita la creación de un
                        nuevo mundo sin fronteras, ni nacionalidades, donde se genera el primer ensayo para transformar
                        y crear un nuevo concepto de república. Un espacio donde todos somos partícipes, donde la utopía
                        es posible.
                    </p>
                </div>
            </div>
            <div class="row push-down-60 home-themes" style="text-align: center">
                <div class="col-xs-3 center-col">
                    <div class="home-glass-image">
                        <img src="{% static 'ghosttown/img/assets2-37.svg' %}">
                    </div>
                    <div class="home-theme-title">
                        LA REPÚBLICA
                    </div>
                    <hr>
                    <p class="home-theme-text">
                        Constitución de un sistema cooperativo en comunidad sin poderes ni dirigentes.
                    </p>
                </div>
                <div class="col-xs-3 center-col">
                    <div class="home-glass-image">
                        <img src="{% static 'ghosttown/img/assets2-38.svg' %}">
                    </div>
                    <div class="home-theme-title">
                        DECONSTRUCCIONES
                    </div>
                    <hr>
                    <p class="home-theme-text">
                        Nuevos tipos de creación
                        colaborativa en continua
                        transformación a través de lo
                        residual.
                    </p>
                </div>
                <div class="col-xs-3 center-col">
                    <div class="home-glass-image">
                        <img src="{% static 'ghosttown/img/assets2-39.svg' %}">
                    </div>
                    <div class="home-theme-title">
                        COLABORATIVO
                    </div>
                    <hr>
                    <p class="home-theme-text">
                        Comportamientos sociales
                        alrededor de la arquitectura.
                    </p>
                </div>
            </div>
        </div>
    </div>

    {% comment %}<div  class="row home-constructions-title">
    <div class="container2">
        <div class="row ">
            <div class="col-xs-6">
                <img src="{% static 'ghosttown/img/Seccion2-Title-construcciones.svg' %}" style="margin-top: 45px;margin-bottom: 45px;">
            </div>
            <div class="col-xs-6">
                {% if user.is_authenticated %}
                    <a href="{% url 'image_map_view' %}">
                         <button id="btn-build" type="button" data-toggle="modal" data-target="#map-modal" class="">construye</button>
                    </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>{% endcomment %}
    <div id="contributors" class="row push-down-30">
        <div class="container2">
            <div class="row">
                <div class="col-xs-12 home-separator"></div>
            </div>
        </div>
    </div>

    <div class="row push-down-60">
        <div class="container2">
            <div class="col-xs-6">
                <div class="row">
                    <img src="{% static 'ghosttown/img/assets2-36.svg' %}">
                </div>
                <div class="row home-avatars">
                    <div class="col-xs-12">
                        <div class="row push-down-30">
                            {% for user_profile in user_profiles %}
                                <div class="col-xs-4">
                                    <img class="hexagon" src="{{ user_profile.hexagon_avatar }}">
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xs-6">
                <div class="row home-gallery">
                    {% for image in marks %}
                        <div class="col-xs-4 thumb-home captionable">
                            <img class="" src="{{ image.thumb_map }}" alt="{{ image.caption }}" width="160px">

                            <a data-toggle="modal" data-target="#myModal{{ image.id }}">
                                <figcaption class="img-title">
                                    <h5>{{ image.caption }}</h5>
                                </figcaption>
                            </a>
                        </div>
                        <div class="modal fade modal-thumb-home" id="myModal{{ image.id }}" tabindex="-1" role="dialog"
                             aria-labelledby="myModalLabel">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content" style="background-color: transparent;box-shadow: none;border: none;">
                                    <div class="modal-body">
                                        <img class="" src="{{ image.thumb_contributors }}" alt="{{ image.caption }}" height="550px">
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>

    </div>

    <div id="citizenship"></div>
    <div class="row background_hexagon_header2 push-down-60">
        <div class="container2 ">
            <div class="row">
                <div class="col-xs-7">
                    <img src="http://www.republicadelosfantasmas.co/static/ghosttown/img/assets2-34.svg" style="margin-top: 55px;margin-bottom: -90px;z-index: 1;position: absolute;">
                </div>
                <div class="col-xs-5">
                </div>
            </div>
        </div>
    </div>

    <div class="row  push-down-140">
        <div class="container2">
            <div class="row">
                <div class="col-xs-6">
                    <div class="row">
                        <div class="col-xs-7 col-xs-offset-3 home-help-title">
                            obtén tu ciudadanía
                        </div>
                    </div>
                    <hr class="hr-citizenship">

                    <div class="row">
                        <div class="col-xs-7 col-xs-offset-3 home-help-text">
                            Nosotros, los ciudadanos
                            de la República de los Fantasmas,
                            en búsqueda de la libertad,
                            constituimos una república donde
                            las fronteras no existen, donde las
                            nacionalidades no se imponen sino que se
                            construyen, donde participar es crear,
                            un lugar donde desaparecer es existir.
                        </div>
                    </div>

                </div>
                <!--HOME REGISTER CARD-->
                <form id="registerForm" method="post" enctype='multipart/form-data' action="{% url 'index' %}"
                      class="form">
                    {% csrf_token %}
                    {{ user_profile_form.form_name }}
                    <div class="col-xs-6">
                        <div class="row">
                            <div class="col-xs-12">
                                <div class="row home-form-card">
                                    <div class="col-xs-12 home-form-card-title ">
                                        republica de los fantasmas
                                    </div>
                                    <img src="{% static 'ghosttown/img/assets2-44.svg' %}"
                                         style="width: 400px;padding-right: 20px;padding-left: 20px;">

                                    <div class="col-xs-12 home-form-card-sub-title">
                                        identificación personal
                                    </div>
                                    <div class="col-xs-12 home-form-card-band">
                                        ciudadania virtual numero: <span
                                            id="id_citizen">{{ request.user.username }}</span>
                                    </div>
                                    <div class="col-xs-9 home-form-card-form">
                                        {% comment %}{{ user_profile_form }}{% endcomment %}
                                        <div class="row push-down-10">
                                            <div class="col-xs-6">
                                                <label data-toggle="tooltip" data-placement="top"
                                                       title="{{ user_profile_form.first_names.errors.as_text }}"
                                                       for="id_first_names">Nombres:</label>
                                                {% if user.is_authenticated %}
                                                    {{ user_profile_form.instance.first_name }}
                                                {% else %}
                                                    {{ user_profile_form.first_names }}
                                                {% endif %}
                                                <hr>
                                            </div>
                                            <div class="col-xs-6">
                                                <label data-toggle="tooltip" data-placement="top"
                                                       title="{{ user_profile_form.last_names.errors.as_text }}"
                                                       for="id_last_names">Apellidos:</label>
                                                {% if user.is_authenticated %}
                                                    {{ user_profile_form.instance.last_name }}
                                                {% else %}
                                                    {{ user_profile_form.last_names }}
                                                {% endif %}
                                                <hr>
                                            </div>
                                        </div>
                                        {% if not user.is_authenticated %}
                                            <div class="row push-down-10">
                                                <div class="col-xs-6">
                                                    <label data-toggle="tooltip" data-placement="top"
                                                           title="{{ user_profile_form.password1.errors.as_text }}"
                                                           for="id_password1">Contraseña:</label>
                                                    {{ user_profile_form.password1 }}
                                                    <hr>
                                                </div>
                                                <div class="col-xs-6">
                                                    <label data-toggle="tooltip" data-placement="top"
                                                           title="{{ user_profile_form.password2.errors.as_text }}"
                                                           for="id_password2">Confirmar:</label>
                                                    {{ user_profile_form.password2 }}
                                                    <hr>
                                                </div>
                                            </div>
                                        {% endif %}
                                        <div class="row push-down-10">
                                            <div class="col-xs-6">
                                                <label data-toggle="tooltip" data-placement="top"
                                                       title="{{ user_profile_form.birth_date.errors.as_text }}"
                                                       for="id_birth_date">Cumpleaños:</label>
                                                {% if user.is_authenticated %}
                                                    {{ user_profile_form.instance.birth_date }}
                                                {% else %}
                                                    {{ user_profile_form.birth_date }}
                                                {% endif %}
                                                <hr>
                                            </div>
                                            <div class="col-xs-6">
                                                <label data-toggle="tooltip" data-placement="top"
                                                       title="{{ user_profile_form.gender.errors.as_text }}"
                                                       for="id_gender">Genero:</label>
                                                {% if user.is_authenticated %}
                                                    {{ user_profile_form.instance.gender_unicode }}
                                                {% else %}
                                                    {{ user_profile_form.gender }}
                                                {% endif %}
                                                <hr>
                                            </div>
                                        </div>
                                        <div class="row push-down-10">
                                            <div class="col-xs-12">
                                                <label data-toggle="tooltip" data-placement="top"
                                                       title="{{ user_profile_form.email.errors.as_text }}"
                                                       for="id_email">E-Mail:</label>
                                                {% if user.is_authenticated %}
                                                    {{ user_profile_form.instance.email }}
                                                {% else %}
                                                    {{ user_profile_form.email }}
                                                {% endif %}
                                                <hr>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-3 home-form-card-form">
                                        <label id="label_avatar" data-toggle="tooltip" data-placement="top"
                                               title="{{ user_profile_form.avatar.errors.as_text }}" for="id_avatar">avatar:</label>
                                        {% if user.is_authenticated %}
                                            <img id="imagePreview"
                                                 src="{{ user_profile_form.instance.hexagon_avatar }}">
                                        {% else %}
                                            <div id="imagePreview"></div>
                                            {{ user_profile_form.avatar }}
                                        {% endif %}
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="row push-down-30">
                            {% if not user.is_authenticated %}
                                <button id="btn-im-citizen" type="button" data-toggle="modal" data-target="#reg-modal"
                                        class="">YA SOY CIUDADANO
                                </button>
                                <!-- Modal -->
                                <button id="btn-send-my-request" type="submit" class="">ENVIAR MI SOLICITUD</button>
                            {% else %}
                                <a href="{% url 'logout' %}">
                                    <button id="btn-send-my-request" type="button" class="">SALIR</button>
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </form>
                <div class="modal fade" id="reg-modal" tabindex="-1" role="dialog" aria-labelledby="regModalLabel">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-body home-form-card-form home-form-card">
                                <form id="login-form" method="post" action="{% url 'index' %}" class="form">
                                    <div class="row">
                                        {% csrf_token %}
                                        {{ login_form.form_name }}
                                        <div class="col-xs-12 home-form-card-title ">
                                            republica de los fantasmas
                                        </div>
                                        <img src="{% static 'ghosttown/img/Home-Form-DecorativeTab.svg' %}"
                                             style="width: 580px;padding-right: 20px;padding-left: 20px; margin-bottom: 35px;">

                                        <div class="col-xs-12">
                                            {% if login_form.errors %}
                                                {{ login_form.errors.as_text }}
                                            {% endif %}
                                        </div>
                                        <div class="col-xs-6">
                                            <label data-toggle="tooltip" data-placement="top"
                                                   title="{{ login_form.username.errors.as_text }}" for="id_username">Id
                                                de Ciudadano:</label>
                                            {{ login_form.username }}
                                        </div>
                                        <div class="col-xs-6">
                                            <label data-toggle="tooltip" data-placement="top"
                                                   title="{{ login_form.password.errors.as_text }}" for="id_password">Contraseña:</label>
                                            {{ login_form.password }}
                                        </div>
                                        <div class="col-xs-12" style="text-align: center;margin-top: 10px;">
                                            <label data-toggle="tooltip" data-placement="top"
                                                   title="{{ login_form.remember_me.errors.as_text }}"
                                                   for="id_password">Recuerdame:</label>
                                            {{ login_form.remember_me }}
                                        </div>
                                    </div>
                                    <div class="row" style="margin-top: 10px;">
                                        <div class="col-xs-12">
                                            <button id="btn-send-my-request" type="submit" class="">INGRESAR</button>
                                        </div>
                                    </div>
                                    {% if login_form.errors %}
                                        <script type="text/javascript">
                                            $(window).load(function () {
                                                $('#reg-modal').modal('show');
                                                $('label').tooltip('show')
                                            });
                                        </script>
                                    {% endif %}
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!--end home register card-->
            </div>
            <div class="row push-down-60">
                <div class="col-xs-12">
                    <div class="fb-share-button" data-href="http://www.republicadelosfantasmas.co/" data-layout="button_count" style="float:right;"></div>
                </div>
            </div>
        </div>
    </div>


{% endblock %}

{% block footer %}
    {% include  'sections/footer.html' %}
{% endblock %}

{% block extra_js %}
    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD5YOOUwXpULiYGPoYql-FY-nUES5Tb8dY&callback=initMap"></script>
    <script type="text/javascript">

        var map;
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                scrollwheel: false,
                center: {lat: 3.2016197, lng: -76.4026165},
                zoom: 16
            });
            var iconBase = '{% static "ghosttown/img/icons/icono-mapa.png" %}';
            {% for mark in marks %}
                var contentString{{ forloop.counter }} = '<img src="{{ mark.thumb_map }}" width="100px">';
                var infowindow{{ forloop.counter }} = new google.maps.InfoWindow({
                    content: contentString{{ forloop.counter }}
                });
                var marker{{ forloop.counter }} = new google.maps.Marker({
                    position: {
                        lat: {{ mark.position.latitude|unlocalize }},
                        lng: {{ mark.position.longitude|unlocalize }}
                    },
                    map: map,
                    icon: iconBase
                });

                marker{{ forloop.counter }}.addListener('click', function () {
                    infowindow{{ forloop.counter }}.open(map, marker{{ forloop.counter }});
                });
                infowindow{{ forloop.counter }}.open(map, marker{{ forloop.counter }});

            {% endfor %}
        }

        function grabMyPosition() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(centerMe);
            } else {
                alert("You don't support this");
            }
        }
        function centerMe(position) {
            var coords = new google.maps.LatLng(
                    position.coords.latitude,
                    position.coords.longitude
            );

            map.setCenter(coords);
            // or
            map.panTo(coords);
        }
        (function ($) {
            $(window).load(function () {
                $(".home-gallery").mCustomScrollbar({theme: 'inset-dark'});
                $(".home-avatars").mCustomScrollbar({theme: 'inset-dark'});
            });
        })(jQuery);
        $(document).ready(function () {

            $('.captionable').hover(function () {
                $(this).find('.img-title').fadeIn(300);
            }, function () {
                $(this).find('.img-title').fadeOut(100);
            });

            $('label').tooltip('show');

            //for avatar
            $(function () {
                $("#id_birth_date").datepicker({
                    changeMonth: true,
                    changeYear: true,
                    dateFormat: 'yy-mm-dd',
                    yearRange: '1900:2040'
                });
                $("#id_avatar").hide();
                $("#imagePreview").on('click', function () {
                    $("#id_avatar").click();
                });
                $("#id_avatar").on("change", function () {
                    var files = !!this.files ? this.files : [];
                    if (!files.length || !window.FileReader) return; // no file selected, or no FileReader support

                    if (/^image/.test(files[0].type)) { // only image file
                        var reader = new FileReader(); // instance of the FileReader
                        reader.readAsDataURL(files[0]); // read the local file

                        reader.onloadend = function () { // set image data as background of div
                            $("#imagePreview").css("background-image", "url(" + this.result + ")");
                        }
                    }
                });
            });

        });
    </script>
{% endblock %}